

(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-7175f98f"],{"1ec3":function(t,e,s){},3701:function(t,e,s){"use strict";var r=s("99ce"),i=s.n(r);i.a},"684e":function(t,e,s){"use strict";var r=s("1ec3"),i=s.n(r);i.a},9560:function(t,e,s){"use strict";var r=s("b775");e["a"]={getResourceInfo:Object(r["a"])("/resource/getOrderDetail"),getResourceList:Object(r["a"])("/resource/getResourceOrderList"),updateResourceStatus:Object(r["b"])("/resource/updateOrderStatus")}},"99ce":function(t,e,s){},"9dd8":function(t,e,s){"use strict";var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"resource"},[s("div",{staticClass:"resource-content"},[s("el-form",{staticClass:"base-info",attrs:{"label-position":"left",rules:t.versionRules,"label-width":"270px"}},[s("el-form-item",{staticClass:"half",attrs:{label:"资源名称",prop:"required"}},[t._v("\n        "+t._s(t.resourceInfo.resourceName)+"\n      ")]),s("el-form-item",{staticClass:"half",attrs:{label:"版本号",prop:"required"}},[t._v("\n        "+t._s(t.resourceInfo.version)+"\n      ")]),s("el-form-item",{staticClass:"half",attrs:{label:"机型",prop:"required"}},[t._v("\n        "+t._s(t.resourceInfo.productName)+"\n      ")])],1),t._l(t.categoryList,(function(e){return s("div",{key:e.id,staticClass:"category-item font-14"},[e.categoryName?s("div",{staticClass:"category-item__title"},[t._v(t._s(e.categoryName))]):t._e(),e.subList.length>0?s("el-form",{staticClass:"category-item__content",attrs:{"label-position":"top","label-width":"200px"}},t._l(e.subList,(function(e){return s("el-form-item",{key:e.id,attrs:{label:e.categoryName}},t._l(e.keyList,(function(e){return s("div",{key:e.id,staticClass:"detail-item"},[s("div",{staticClass:"detail-item-title"},[t._v(t._s(e.keyName))]),s("div",{staticClass:"detail-item-content"},[s("span",{staticClass:"detail-item-content__label hidden",attrs:{title:e.fileName}},[t._v(t._s(e.fileName||"无"))]),e.resourceValue?s("div",{staticClass:"detail-item-content__btn"},[s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.simulateClick(e.resourceValue,e.fileName)}}},[t._v("下载")])],1):t._e(),e.valueName?s("div",{staticClass:"detail-item-content__sub"},[t._v(t._s(t._f("arrayFormat")(e.valueName)))]):t._e()])])})),0)})),1):t._e(),e.keyList.filter((function(t){return t.keyType<6})).length>0?s("el-form",{staticClass:"category-item__content category-item__hardware",attrs:{"label-position":"left"}},[t._l(e.keyList.filter((function(t){return t.keyType<6})),(function(e){return[s("el-form-item",{key:e.id,attrs:{label:e.keyName}},[s("div",{staticClass:"detail-item"},[t._v(t._s(t._f("arrayFormat")(e.valueName)))])])]}))],2):t._e(),e.keyList.filter((function(t){return t.keyType>=6})).length>0?s("el-form",{attrs:{"label-width":"270px","label-position":"left"}},[t._l(e.keyList.filter((function(t){return t.keyType>=6})),(function(e){return[s("el-form-item",{key:e.id,staticClass:"mb-40",attrs:{label:e.keyName}},[6===e.keyType?s("div",[s("div",{staticClass:"download hidden"},[t._v(t._s(e.fileName||"无"))]),e.resourceValue?s("el-button",{attrs:{type:"text"},on:{click:function(s){return t.simulateClick(e.resourceValue,e.fileName)}}},[t._v("\n                下载\n              ")]):t._e()],1):s("div",[t._v(t._s(e.valueName))])])]}))],2):t._e()],1)})),s("el-form",{staticClass:"imei-wrapper",attrs:{"label-width":"270px","label-position":"left"}},[s("el-form-item",{attrs:{label:"测试IMEI/openid号"}},[s("el-popover",{attrs:{width:"300",placement:"bottom-start",trigger:"click"},on:{show:function(e){return t.handleSetTab("test")}}},[s("el-tabs",{model:{value:t.testTab,callback:function(e){t.testTab=e},expression:"testTab"}},[s("el-tab-pane",{attrs:{label:"测试IMEI号",name:"imei"}},[t.testIdList?t._l(t.testIdList,(function(e){return s("div",{key:e.imei},[t._v(t._s(e.imei))])})):t._e()],2),s("el-tab-pane",{attrs:{label:"测试openid号",name:"openid"}},t._l(t.testIdList,(function(e){return s("div",{key:e.openid},[t._v(t._s(e.openid))])})),0)],1),s("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.handlePreviewImei("test")}},slot:"reference"},[t._v("预览")])],1),s("el-button",{staticClass:"ml-134",attrs:{type:"text"},on:{click:function(e){return t.handleDownloadImei("test")}}},[t._v("下载")])],1),s("el-form-item",{attrs:{label:"全量IMEI/openid号"}},[s("el-popover",{attrs:{width:"300",placement:"bottom-start",trigger:"click"},on:{show:function(e){return t.handleSetTab("full")}}},[s("el-tabs",{model:{value:t.fullTab,callback:function(e){t.fullTab=e},expression:"fullTab"}},[s("el-tab-pane",{attrs:{label:"全量IMEI号",name:"imei"}},[t.fullIdList?t._l(t.fullIdList,(function(e){return s("div",{key:e.imei},[t._v(t._s(e.imei))])})):t._e()],2),s("el-tab-pane",{attrs:{label:"全量openid号",name:"openid"}},t._l(t.fullIdList,(function(e){return s("div",{key:e.openid},[t._v(t._s(e.openid))])})),0)],1),s("el-button",{attrs:{slot:"reference",type:"text"},on:{click:function(e){return t.handlePreviewImei("full")}},slot:"reference"},[t._v("预览")])],1),s("el-button",{staticClass:"ml-134",attrs:{type:"text"},on:{click:function(e){return t.handleDownloadImei("full")}}},[t._v("下载")])],1)],1)],2)])},i=[],n=(s("8e6e"),s("456d"),s("96cf"),s("3b8d")),a=(s("55dd"),s("bd86")),o=(s("ac6a"),s("a481"),s("be9e")),c=s("fa7d");function l(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function u(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?l(s,!0).forEach((function(e){Object(a["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):l(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var d={filters:{arrayFormat:function(t){return t?t.replace(/,/g,"   "):t}},props:{resourceInfo:{type:Object,default:function(){}}},data:function(){return{versionRules:{required:{required:!0}},testIdList:null,fullIdList:null,testTab:"",fullTab:""}},computed:{categoryList:function(){var t={length:0};return this.resourceInfo.categoryList.forEach((function(e){t[e.id]=u({},e,{keyList:[],subList:[]}),t.length++})),t[0]={id:100,subList:[],keyList:[],sort:999,fatherId:0},t.length++,this.resourceInfo.detailList.forEach((function(e){t[e.categoryId].keyList.push(e)})),Array.prototype.slice.call(t).forEach((function(e){e.fatherId&&t[e.fatherId].subList.push(e),e.keyList.sort((function(t,e){return t.keySort-e.keySort}))})),Array.prototype.slice.call(t).filter((function(t){return 0===t.fatherId})).sort((function(t,e){return t.sort-e.sort}))}},methods:{simulateClick:c["b"],handlePreviewImei:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!this["".concat(e,"IdList")]){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,o["a"].getImeiList({id:this.resourceInfo.id,isFull:"test"===e?0:1});case 4:s=t.sent,this["".concat(e,"IdList")]=s.data;case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),handleSetTab:function(t){var e="".concat(t,"Tab");"0"===this[e]&&(this[e]="imei")},handleDownloadImei:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s,r,i;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return s="test"===e?"测试":"全量",t.next=3,o["a"].downloadImeiFile({id:this.resourceInfo.id,isFull:"test"===e?0:1});case 3:r=t.sent,i=new Blob([r.data]),window.navigator.msSaveOrOpenBlob?navigator.msSaveBlob(i,"".concat(s,"imei号.xlsx")):this.simulateClick(URL.createObjectURL(i),"".concat(s,"imei号.xlsx"));case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}()}},p=d,f=(s("3701"),s("2877")),m=Object(f["a"])(p,r,i,!1,null,"4c5c4e33",null);e["a"]=m.exports},be9e:function(t,e,s){"use strict";var r=s("b775");e["a"]={getProvinceList:Object(r["a"])("/tool/listProvince"),getCityList:Object(r["a"])("/tool/listCity"),getAgentInfo:Object(r["a"])("/common/getAgentInfo"),getImeiTemplate:Object(r["a"])("/openidUpload/getTemplateUrl"),uploadImeiByCustom:Object(r["b"])("/openidUpload/consumerUpload"),uploadImeiByAgent:Object(r["b"])("/openidUpload/agentUpload"),getImeiList:Object(r["a"])("/openidUpload/getImei"),downloadImeiFile:Object(r["a"])("/openidUpload/getImeiFile",{},{responseType:"blob"})}},d866:function(t,e,s){"use strict";s.r(e);var r=function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"commodity"},[s("div",{staticClass:"back-route"},[s("el-button",{attrs:{type:"text",icon:"el-icon-arrow-left"},on:{click:t.handleBack}},[t._v("\n      "+t._s(t.backTitle)+"\n    ")])],1),s("div",{staticClass:"commodity-main"},[t.isInit?[s("section",{staticClass:"section section-detail"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("订单详情")]),s("div",{staticClass:"section-content"},[s("span",[t._v("商品订单号："+t._s(t.productOrder.productOrderSn))]),s("span",[t._v("提单日期："+t._s(t.createTime))])])]),"orderProcess"!==this.pageType?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("订单进度")]),s("div",{staticClass:"section-step-content"},[s("div",{staticClass:"step-container"},[s("steps2",{attrs:{step:t.currentStep,steps:t.steps}})],1),s("div",{staticClass:"step-explain"},[s("div",{staticClass:"step-explain-title"},[t._v("进度说明：")]),s("div",{staticClass:"step-explain-content"},[t._l(t.reverseRecordList,(function(e){return[s("div",{key:e.id,staticClass:"step-explain-item"},[s("span",{},[t._v(t._s(t._f("formatTime")(e.gmtCreate)))]),s("span"),s("span",[t._v(t._s(e.remark))])])]}))],2)])])]):t._e(),2===this.userInfo.role&&"orderProcess"===this.pageType?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("客户信息")]),s("div",{staticClass:"section-content info-list"},[s("div",[s("span",[t._v("客户名称：")]),s("span",[t._v(t._s(t.productOrder.userName))])]),s("el-popover",{attrs:{placement:"bottom-start",width:"400",trigger:"hover"}},[s("el-form",{staticClass:"customer-info",attrs:{"label-width":"120px",rules:t.requiredRule,"label-position":"right"}},[s("el-form-item",{attrs:{label:"企业名称：",prop:"required"}},[s("span",[t._v(t._s(t.invoiceInfo.corporateName))])]),s("el-form-item",{attrs:{label:"企业地址：",prop:"required"}},[s("span",[t._v(t._s(t.detailAddress))])]),s("el-form-item",{attrs:{label:"联系人姓名：",prop:"required"}},[s("span",[t._v(t._s(t.productOrder.purchaserName))])]),s("el-form-item",{attrs:{label:"联系人手机：",prop:"required"}},[s("span",[t._v(t._s(t.productOrder.purchaserPhone))])])],1),s("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("查看")])],1)],1)]):t._e(),"agentSubmitOrder"!==this.pageType?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("\n          "+t._s("orderProcess"===this.pageType?"采购信息":"基本信息")+"\n        ")]),s("div",{staticClass:"section-content"},[s("base-info",{attrs:{"order-data":t.orderData}})],1)]):t._e(),s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("商品信息")]),s("div",{staticClass:"section-content"},[s("commodity-table",{attrs:{type:"commodity","page-type":t.pageType,"product-order":t.productOrder}})],1)]),t.resourceData?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("定制资源")]),s("resource-info",{attrs:{"resource-info":t.resourceData}})],1):t._e(),2===t.userInfo.role&&"agentSubmitOrder"===t.pageType&&null!=t.customerInfo?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("客户信息")]),s("div",{staticClass:"section-content info-list"},[s("div",[s("span",[t._v("公司名称：")]),s("span",[t._v(t._s(t.customerInfo.corporateName))])]),s("div",[s("span",[t._v("联系人：")]),s("span",[t._v(t._s(t.customerInfo.contactName))])]),s("div",[s("span",[t._v("收货地址：")]),s("span",[t._v(t._s(t.detailAddress))])]),s("div",[s("span",[t._v("联系方式：")]),s("span",[t._v(t._s(t.customerInfo.contactPhoneNumber))])])])]):t._e(),"orderProcess"!==this.pageType&&t.siList.length>0?s("section",{staticClass:"section"},[s("div",{staticClass:"section-title ent-font-bold"},[t._v("SI信息")]),t._l(t.siList,(function(e){return s("div",{key:e.siId,staticClass:"section-content info-list"},[s("div",[s("span",[t._v("机构名称：")]),s("span",[t._v(t._s(e.siName))])]),s("div",[s("span",[t._v("机构ID：")]),s("span",[t._v(t._s(e.siId))])])])}))],2):t._e()]:t._e()],2)])},i=[],n=(s("8e6e"),s("456d"),s("55dd"),s("6762"),s("2fdb"),s("ac6a"),s("96cf"),s("3b8d")),a=s("75fc"),o=s("bd86"),c=s("116e"),l=s("7699"),u=s("9dd8"),d=s("bcc0"),p=s("4bab"),f=s("9560"),m=s("fa7d"),v=s("2f62");function b(t,e){var s=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),s.push.apply(s,r)}return s}function h(t){for(var e=1;e<arguments.length;e++){var s=null!=arguments[e]?arguments[e]:{};e%2?b(s,!0).forEach((function(e){Object(o["a"])(t,e,s[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(s)):b(s).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(s,e))}))}return t}var _={clientCommodityOrder:"返回我的商品订单",agentSubmitOrder:"返回我提交的订单",orderProcess:"返回订单处理"},g={filters:{formatTime:function(t){return Object(m["c"])(t,"YYYY-MM-DD HH:mm")}},components:{Steps2:c["a"],BaseInfo:l["a"],ResourceInfo:u["a"],CommodityTable:d["a"]},data:function(){return{pageType:"clientCommodityOrder",steps:[],isInit:!1,orderData:{},resourceData:null,orderRecords:[],invoiceInfo:{},shippingAddr:{},productOrder:{},siList:[],customerInfo:null,requiredRule:{required:{required:!0}},stepsMap:{clientCommodityOrder:[{title:"订单生成",description:""},{title:"关联资源",description:""},{title:"验收",description:""},{title:"付款",description:""},{title:"发货",description:""},{title:"收货",description:""}],orderProcess:[{title:"订单生成",description:""},{title:"关联资源",description:""},{title:"验收",description:""},{title:"付款",description:""},{title:"发货",description:""},{title:"收货",description:""}],agentSubmitOrder:[{title:"订单生成",description:""},{title:"审核",description:""},{title:"上传测试IMEI号",description:""},{title:"验收",description:""},{title:"上传全量IMEI号",description:""},{title:"发货",description:""}]}}},created:function(){var t=this.$route.query,e=t.pageType,s=t.id;this.pageType=e,this.steps=this.stepsMap[this.pageType],this.id=s,this.initOrderData(s)},computed:h({},Object(v["e"])({userInfo:function(t){return t.user.userInfo}}),{currentStep:function(){return this.steps.filter((function(t){return""!==t.description})).length},backTitle:function(){return _[this.pageType]},productList:function(){return this.productOrder.productOrderDetails},createTime:function(){return this.timeFormat(this.productOrder.createTime)},reverseRecordList:function(){return Object(a["a"])(this.orderRecords).reverse()},detailAddress:function(){if(this.customerInfo){var t=this.customerInfo,e=t.contactAddrProvince,s=t.contactAddrCity,r=t.contactAddrDetail;return e+s+r}return""}}),methods:{timeFormat:m["c"],handleBack:function(){this.$router.push({name:this.pageType})},initOrderData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s,r,i,n,a,o,c,l;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].getOrderInfo({id:e,productOrderType:1});case 2:if(s=t.sent,r=s.data,i=r.productOrderVO,n=r.shippingAddr,a=r.invoiceInfo,o=r.orderRecords,this.orderData=s.data,this.productOrder=i,this.shippingAddr=n,this.invoiceInfo=a,this.orderRecords=o,c=i.resourceOrderId,l=i.corporateId,!c){t.next=15;break}return t.next=13,this.initResourceData(c);case 13:t.next=16;break;case 15:this.isInit=!0;case 16:l&&this.initCsutomData(l),"agentSubmitOrder"!==this.pageType?this.formatCustomStep():this.formatAgentStep();case 18:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initResourceData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,f["a"].getResourceInfo({id:e});case 2:s=t.sent,this.resourceData=s.data,this.resourceData.siList&&(this.siList=this.resourceData.siList),this.isInit=!0;case 6:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),initCsutomData:function(){var t=Object(n["a"])(regeneratorRuntime.mark((function t(e){var s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,p["a"].getCorporateDetail({corporateId:e});case 2:s=t.sent,this.customerInfo=s.data;case 4:case"end":return t.stop()}}),t,this)})));function e(e){return t.apply(this,arguments)}return e}(),formatCustomStep:function(){var t=this,e={4:"验收不通过",5:"验收通过"},s="YYYY-MM-DD HH:mm";if(this.resourceData){var r=this.resourceData.recordList,i=r.filter((function(t){return 5===t.status}));i.length&&(this.steps[2].title="待验收",this.steps[2].description=this.timeFormat(i[i.length-1].gmtCreate,s))}this.orderRecords.forEach((function(r){if(1===r.status)t.steps[0].description=t.timeFormat(r.gmtCreate,s);else if(3===r.status)t.steps[1].description=t.timeFormat(r.gmtCreate,s);else if([4,5].includes(r.status))switch(r.status){case 4:if(t.steps[2].description&&new Date(r.gmtCreate).getTime()<new Date(t.steps[2].description))break;t.steps[2].description=t.timeFormat(r.gmtCreate,s),t.steps[2].title=e[r.status];break;case 5:t.steps[2].description=t.timeFormat(r.gmtCreate,s),t.steps[2].title=e[r.status];break}else 6===r.status?t.steps[3].description=t.timeFormat(r.gmtCreate,s):7===r.status?(t.steps[4].title="已发货",t.steps[4].description=t.timeFormat(r.gmtCreate,s)):8===r.status&&(t.steps[5].description=t.timeFormat(r.gmtCreate,s))}))},formatAgentStep:function(){var t=this,e={2:"审核不通过",3:"审核通过"},s={5:"待验收",6:"验收不通过",7:"验收通过"},r="YYYY-MM-DD HH:mm";Object(a["a"])(this.orderRecords).sort((function(t,e){return t.status-e.status})).forEach((function(i){if(1===i.status)t.steps[0].description=t.timeFormat(i.gmtCreate,r);else if([2,3].includes(i.status)&&!t.steps[1].description)t.steps[1].description=t.timeFormat(i.gmtCreate,r),t.steps[1].title=e[i.status];else if(4===i.status)t.steps[2].description=t.timeFormat(i.gmtCreate,r);else if([5,6,7].includes(i.status)){if(t.steps[2].description){if(6===i.status&&new Date(i.gmtCreate).getTime()<new Date(t.steps[3].description).getTime())return;t.steps[3].description=t.timeFormat(i.gmtCreate,r),t.steps[3].title=s[i.status]}}else 8===i.status?t.steps[4].description=t.timeFormat(i.gmtCreate,r):9===i.status&&(t.steps[5].title="已发货",t.steps[5].description=t.timeFormat(i.gmtCreate,r))}))}}},y=g,C=(s("684e"),s("2877")),O=Object(C["a"])(y,r,i,!1,null,"6df25cc2",null);e["default"]=O.exports}}]);
//# sourceMappingURL=chunk-7175f98f.89659ca0.js.map


